function nirx_write_hdr(file,hdr)
% Description:
%   function to write nirx format header file
% Inputs:
%   file = name of file to write
%   hdr = hdr structure, see nirx_read_hdr.m
% Example:
%   nirx_write_hdr('filename.hdr',hdr);

fp = fopen(file,'w');
fprintf(fp,'[GeneralInfo]\n');
fprintf(fp,['FileName="' hdr.file '"\n']);
[~,dow] = weekday(date,'short');
fprintf(fp,['Date="' dow ', ' datestr(date,'mmm dd, yyyy') '"\n']);
fprintf(fp,['Time="' strtrim(datestr(clock, 'HH:MM PM')) '"\n']);
fprintf(fp,['Device="' hdr.device '"\n']);
fprintf(fp,['Source="' hdr.source '"\n']);
fprintf(fp,['Mod="' hdr.mod '"\n']);
fprintf(fp,['NIRStar="' num2str(hdr.ver) '"\n']);
fprintf(fp,['Subject=' num2str(hdr.sub) '\n']);
fprintf(fp,'\n[ImagingParameters]\n');
fprintf(fp,['Sources=' num2str(hdr.sources) '\n']);
fprintf(fp,['Detectors=' num2str(hdr.detectors) '\n']);
fprintf(fp,['Steps=' num2str(hdr.steps) '\n']);
fprintf(fp,['Wavelengths="' num2str(hdr.wl) '"\n']);
fprintf(fp,['TrigIns=' num2str(hdr.trigin) '\n']);
fprintf(fp,['TrigOuts=' num2str(hdr.trigout) '\n']);
fprintf(fp,['AnIns=' num2str(hdr.anins) '\n']);
fprintf(fp,['SamplingRate=' num2str(hdr.sr) '\n']);
fprintf(fp,['ModAmp="' num2str(hdr.mod) '"\n']);
fprintf(fp,['Threshold="' num2str(hdr.thres) '"\n']);
fprintf(fp,'\n[Paradigm]\n');
fprintf(fp,['StimulusType="' hdr.stimtype '"\n']);
fprintf(fp,'\n[ExperimentNotes]\n');
fprintf(fp,['Notes="' hdr.notes '"\n']);
fprintf(fp,'\n[GainSettings]\nGains="#\n');
[nrows,ncols]= size(hdr.gains);
for ii=1:nrows
    for jj=1:ncols
        fprintf(fp,'%s\t',num2str(hdr.gains(ii,jj)));
    end
    fprintf(fp,'\n');
end
fprintf(fp,'#"\n');
fprintf(fp,'S-D-Key="');
for ii=1:le
fprintf(fp,'\n[DataStructure]\nS-D-Mask="#\n');
for ii=1:nrows
    for jj=1:ncols
        fprintf(fp,'%s\t',num2str(hdr.SDmask(ii,jj)));
    end
    fprintf(fp,'\n');
end
fprintf(fp,'#"\n');
fprintf(fp,'\n[ChannelsDistance]\nChanDis="');
for ii=1:length(hdr.dist)-1
    fprintf(fp,'%d\t',hdr.dist(ii));
end
fprintf(fp,'%d"',hdr.dist(end));
fclose(fp);