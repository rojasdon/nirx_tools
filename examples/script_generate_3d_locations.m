% script to plot optode locations assuming all in MNI coordinates
% uses SPM for surfaces, so must have on path

set(gcf, 'renderer', 'zbuffer');

% 3d locations for sources and detectors
D = [0.2313   80.7710   35.4170
    0.3761   27.3900   88.6680
  -27.4958   56.9311   60.3420
  -36.1580   -9.9839   89.7520
  -60.1819   22.7162   55.5440
  -64.4658   48.0353   16.9210
  -80.2801  -13.7597   29.1600
  -80.7750   14.1203  -11.1350
   29.5142   57.6019   59.5400
   37.6720   -9.6241   88.4120
   62.2931   23.7228   55.6300
   67.9142   49.8297   16.3670
   83.4559  -12.7763   29.2080
   81.8151   15.4167  -11.3300
  -84.8302  -46.0217   -7.0560
  -63.5562  -47.0088   65.6240
    0.3858  -47.3180   99.4320
  -67.2723  -76.2907   28.3820
  -28.6203  -80.5249   75.4360
  -54.9104  -98.0448  -35.4650
  -36.5114 -100.8529   37.1670
    0.2156 -102.1780   50.6080
   66.6118  -46.6372   65.5800
   85.5488  -45.5453   -7.1300
   31.9197  -80.4871   76.7160
   67.8877  -75.9043   28.0910
   36.7816 -100.8491   36.3970
   54.9876  -98.0911  -35.5410];

S= [0.3122   58.5120   66.4620
    0.4009   -9.1670  100.2440
  -33.7007   76.8371   21.2270
  -34.0619   26.0111   79.9870
  -50.2438   53.1112   42.1920
  -65.3581  -11.6317   64.3580
  -77.2149   18.6433   24.4600
  -70.2629   42.4743  -11.4200
  -84.1611  -16.0187   -9.3460
   35.7123   77.7259   21.9560
   34.7841   26.4379   78.8080
   51.8362   54.3048   40.8140
   67.1179  -10.9003   63.5800
   79.5341   19.9357   24.4380
   73.0431   44.4217  -12.0000
   85.0799  -15.0203   -9.4900
  -79.5922  -46.5507   30.9490
  -35.5131  -47.2919   91.3150
  -72.4343  -73.4527   -2.4870
  -53.0073  -78.7878   55.9400
    0.3247  -81.1150   82.6150
  -48.4244  -99.3408   21.5990
  -18.9724 -101.7680   46.5360
   38.3838  -47.0731   90.6950
   83.3218  -46.1013   31.2060
   55.6667  -78.5602   56.5610
   73.0557  -73.0683   -2.5400
   19.8776 -101.7930   46.3930
   49.8196  -99.4461   21.7270
    0.1076 -114.8920   14.6570];

Dnames = {
    'AFz'
    'FCz'
    'F1'
    'C1'
    'FC3'
    'F5'
    'C5'
    'FT7'
    'F2'
    'C2'
    'FC4'
    'F6'
    'C6'
    'FT8'
    'TP7'
    'CP3'
    'CPz'
    'P5'
    'P1'
    'PO9'
    'PO3'
    'POz'
    'CP4'
    'TP8'
    'P2'
    'P6'
    'PO4'
    'PO10'};

Snames = {
    'Fz'
    'Cz'
    'AF3'
    'FC1'
    'F3'
    'C3'
    'FC5'
    'F7'
    'T7'
    'AF4'
    'FC2'
    'F4'
    'C4'
    'FC6'
    'F8'
    'T8'
    'CP5'
    'CP1'
    'P7'
    'P3'
    'Pz'
    'PO5'
    'PO1'
    'CP2'
    'CP6'
    'P4'
    'P8'
    'PO2'
    'PO6'
    'Oz'};
    
% spm stuff
spmdir = [spm('dir') filesep 'canonical'];
brain  = 'cortex_8196.surf.gii'; % choose the one (5124, 8196 or 20484) that matches your choice in analysis
head   = 'scalp_2562.surf.gii';

% read in surfaces
cortex = gifti([spmdir filesep brain]);
scalp  = gifti([spmdir filesep head]);

% make nice figure
cb      = patch('faces',cortex.faces,'vertices',cortex.vertices,...
                'edgecolor','none','facecolor',[210 157 166]./255);
cf      = patch('faces',scalp.faces,'vertices',scalp.vertices,...
                'edgecolor','none','facecolor',[204 204 204]./255);

hold on;
scatter3(S(:,1),S(:,2),S(:,3),'r.','SizeData',200);
scatter3(D(:,1),D(:,2),D(:,3),'g.','SizeData',200);
text(S(:,1),S(:,2),S(:,3),Snames);
text(D(:,1),D(:,2),D(:,3),Dnames);
alpha(cf,.4);
axis vis3d image off;
lighting gouraud;
camlight('left');
camlight('right');